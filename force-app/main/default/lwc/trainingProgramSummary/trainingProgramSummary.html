<template>
    <lightning-card title="Training Program Summary" icon-name="custom:custom19">
        <lightning-card>
            <!-- Title Section -->
            <h2 slot="header">
                <lightning-icon icon-name="custom:custom83" size="small" alternative-text="Tasks"></lightning-icon>
                Tasks
            </h2>
    
            <!-- Actions Section -->
            <div slot="actions">
                    <lightning-button-group class="slds-m-bottom_small">
                        <lightning-button
                        label="Week"
                        icon-name="utility:weeklyview"
                        icon-position="right"
                        onclick={handleWeekFilter}
                        variant="neutral">
                    </lightning-button>
                    <lightning-button 
                        label="Month"
                        onclick={handleMonthFilter}
                        icon-name="utility:monthlyview"
                        icon-position="right"
                        variant="neutral">
                    </lightning-button>
                    <lightning-button 
                        label="Quarter"
                        onclick={handleQuarterFilter}
                        icon-name="utility:event"
                        icon-position="right"
                        variant="neutral">
                    </lightning-button>
                    <lightning-button 
                        label="Refresh"
                        onclick={handleRefresh}
                        icon-name="utility:refresh"
                        icon-position="right"
                        variant="neutral">
                    </lightning-button>
                </lightning-button-group>
            </div>
    
            <!-- Filters Section -->
            <lightning-layout>
                <lightning-layout-item flexibility="auto" padding="around-small" size="1">
                    <div class="slds-text-heading--label">Filters</div>
                </lightning-layout-item>
    
                <!-- Intern Filter -->
                <lightning-layout-item flexibility="auto" padding="around-small" class="slds-m-bottom_small">
                    <lightning-combobox 
                        label="Interns" 
                        value={selectedInternId} 
                        options={internOptions}
                        onchange={handleInternChange}>
                    </lightning-combobox>
                </lightning-layout-item>

            </lightning-layout>
            <!-- Intern Details Section with Highlight Panel -->
            <template if:true={selectedInternId}>
                <lightning-card title="Intern Details" icon-name="standard:user">
                    <div class="slds-p-around_medium slds-box slds-theme_default">
                        <div class="slds-grid slds-wrap slds-gutters slds-grid_reverse">
                            <div class="slds-col slds-size_1-of-3 slds-p-around_x-small">
                                <p class="slds-text-title_bold">Program Duration</p>
                                <p class="slds-text-body_regular">{selectedInternDetails.Program_Duration__c}</p>
                            </div>
                            <div class="slds-col slds-size_1-of-3 slds-p-around_x-small">
                                <p class="slds-text-title_bold">Program Name</p>
                                <p class="slds-text-body_regular">{selectedInternDetails.Program__r.Name}</p>
                            </div>
                            <div class="slds-col slds-size_1-of-3 slds-p-around_x-small">
                                <p class="slds-text-title_bold">Department</p>
                                <p class="slds-text-body_regular">{selectedInternDetails.Department__c}</p>
                            </div>
                            <div class="slds-col slds-size_1-of-3 slds-p-around_x-small">
                                <p class="slds-text-title_bold">Asset Assigned</p>
                                <p class="slds-text-body_regular">{selectedInternDetails.Asset_assign__c}</p>
                            </div>
                        </div>
                    </div>
                </lightning-card>
            </template>
                    
        </lightning-card>

        <!-- Exam Schedules Section -->
        <h3 class="">Exam Schedules</h3>
        <template if:true={filteredSchedules}>
            <table class="slds-table slds-table_cell-buffer slds-table_bordered">
                <thead>
                    <tr>
                        <th class="slds-text-title_caps">Exam Name</th>
                        <th class="slds-text-title_caps">Current Period {currentPeriodRange}</th>
                        <th class="slds-text-title_caps">Next Period {nextPeriodRange}</th>
                        <th class="slds-text-title_caps">Ongoing {ongoingPeriodRange}</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Loop through filteredSchedules -->
                    <template for:each={filteredSchedules} for:item="schedule">
                        <tr key={schedule.Id}>
                            <td>{schedule.Name}</td>

                            <!-- Current Period -->
                            <td>
                                <template if:true={schedule.isInCurrentPeriod}>
                                    <p>{schedule.formattedDate}</p>
                                </template>
                            </td>

                            <!-- Next Period -->
                            <td>
                                <template if:true={schedule.isInNextPeriod}>
                                    <p>{schedule.formattedDate}</p>
                                </template>
                            </td>

                            <!-- Ongoing -->
                            <td>
                                <template if:true={schedule.isOngoing}>
                                    <p>{schedule.formattedDate}</p>
                                </template>
                            </td>
                        </tr>
                    </template>
                </tbody>
            </table>
        </template>
    </lightning-card>
</template>
